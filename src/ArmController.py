import rospy
from moveit_msgs.msg import MoveItErrorCodes
from moveit_python import MoveGroupInterface, PlanningSceneInterface


class ArmController(object):

    def __init__(self):
        self.scene = PlanningSceneInterface("base_link")
        self.move_group = MoveGroupInterface("arm", "base_link")
        self.joints = ["shoulder_pan_joint", "shoulder_lift_joint", "upperarm_roll_joint", "elbow_flex_joint",
                        "forearm_roll_joint", "wrist_flex_joint", "wrist_roll_joint"]

    def tuck(self):
        """ Tuck the arm"""
    # pose = [0.0, 1.5, 0.0, -2.3, 0.0, 1.7, 1.57]
    # pose = [-3.6128315925598145, 2.960951089859009, 0.04778321832418442, 0.023, 0.00820612907409668, 0.3782047861633301, -1.14355414282959, -0.698418953125, 0.22227652205276488, 1.510646486956787, -0.06754421838264466, 0.7810066781921386, 1.5715121301864623]
    # pose = [0.5802570067675781, -1.0420306703491211, -0.021242933141708373, 1.3913795001098632, 0.01644048444290161, 1.5027445398254395, 1.5715121301864623]
        # pose = [-0.21396153342407226, 0.7968288877563476, 0.012121146750926973, -1.8863538258483887, -0.013471398732471468, 1.1042927347106934, 1.6363228830551146]
    # pose = [1.0369997702868652, 1.2428337553100586, 0.7158348692779541, -2.2012036793640135, -0.38661262043457034, 0.9570311151428222, 1.6363228830551146]
    # pose = [0.8713298522265625, 1.2428337553100586, 1.0989465845947266, -2.3005288594177244, -1.8258701229904175, 1.3366907678527833, 2.345405605718994]
    # pose = [0.9445772849353027, 1.437649390991211, 2.4250733984832764, -1.6712134831359864, -3.054972138485718, 1.4900892816467286, -2.9207505908752442]
        pose = [1.3204026900561523, 1.39968313961792, -0.19995170252275468, 1.7200352198669433, 0.0003344302560806256, 1.6599777780456544, 0.00033231927504539377]
        while not rospy.is_shutdown():
            result = self.move_group.moveToJointPosition(
                self.joints, pose, 0.02)
            if result.error_code.val == MoveItErrorCodes.SUCCESS:
                return

    def extend(self):
        """ Extend the arm forward"""
    # pose = [0.0, -0.5, 0.0, 0.8, 0.0, 0.9, 1.57] 
    # pose = [-2.5101327896118164, 2.673495292663574, 0.05001102387905121, 0.023, -0.0006921291351318359, 0.3068747156677246, -0.026432446357421875, 0.07125582485961914, -0.010121570693969725, -1.41618905, 0.009921062507820128, 1.4582594476623536, 1.5795655521606444]
        # pose = [0.9445772849353027, 1.2646929243164062, 1.6600000990753174, -1.7053445332458497, 2.7776067589904785, 1.3723562799377442, -2.9219009605194093]
    # pose = [1.3196354590686035, 1.4012171247558594, -1.5437189208145141, 1.7196513659545898, -4.9811086463930065e-05, 1.6599777780456544, -0.0012016612062811863]
        pose = [1.3196354590686035, 1.4000665166931152, -0.8541943298454284, 1.9857970721313476, -1.699699964604187, 0.975822313873291, -0.00043467143127918356]
        while not rospy.is_shutdown():
            result = self.move_group.moveToJointPosition(
                self.joints, pose, 0.02)
            if result.error_code.val == MoveItErrorCodes.SUCCESS:
                return
